!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=4)}([function(t){t.exports=[{id:1,title:"Square",description:"アニメーションの練習。四角をただ回転させてるだけ。",source:"https://github.com/ttk1/wglp/tree/master/src/1"},{id:2,title:"Cube",description:"立方体を作ってみた。",source:"https://github.com/ttk1/wglp/tree/master/src/2"},{id:3,title:"Mouse",description:"マウスでぐりぐり。",source:"https://github.com/ttk1/wglp/tree/master/src/3"},{id:4,title:"TransformFeedbackの練習",description:"TransformFeedbackの練習。結果はconsoleに表示する。",source:"https://github.com/ttk1/wglp/tree/master/src/4"}]},function(t,e,n){e.rot_x=t=>{const e=n(2).getMatrix(4,4);return e.setValue(0,0,1),e.setValue(1,1,Math.cos(t)),e.setValue(2,1,-Math.sin(t)),e.setValue(1,2,Math.sin(t)),e.setValue(2,2,Math.cos(t)),e.setValue(3,3,1),e},e.rot_y=t=>{const e=n(2).getMatrix(4,4);return e.setValue(0,0,Math.cos(t)),e.setValue(2,0,Math.sin(t)),e.setValue(1,1,1),e.setValue(0,2,-Math.sin(t)),e.setValue(2,2,Math.cos(t)),e.setValue(3,3,1),e},e.rot_z=t=>{const e=n(2).getMatrix(4,4);return e.setValue(0,0,Math.cos(t)),e.setValue(1,0,-Math.sin(t)),e.setValue(0,1,Math.sin(t)),e.setValue(1,1,Math.cos(t)),e.setValue(2,2,1),e.setValue(3,3,1),e}},function(t,e){e.getMatrix=(t,e)=>new n(t,e);class n{constructor(t,e){this.m=t,this.n=e,this.init()}getArray(){const t=[];for(let e=0;e<this.m;e++)for(let n=0;n<this.n;n++)t[e+this.m*n]=this.matrix[e][n];return t}check(t,e){if(t<0||t>=this.m||e<0||e>=this.n)throw new Error("範囲外")}init(){this.matrix=[];for(let t=0;t<this.m;t++){this.matrix[t]=[];for(let e=0;e<this.n;e++)this.matrix[t][e]=0}}setValue(t,e,n){this.check(t,e),this.matrix[t][e]=n}getValue(t,e){return this.check(t,e),this.matrix[t][e]}mul(t){if(this.n!=t.m)throw new Error("サイズの不一致");const e=new n(this.m,t.n);for(let n=0;n<this.m;n++)for(let o=0;o<t.n;o++)e.setValue(n,o,r(n,o,this,t));return e;function r(t,e,n,r){let o=0;for(let i=0;i<n.n;i++)o+=n.getValue(t,i)*r.getValue(i,e);return o}}}},,function(t,e,n){window.onload=()=>{const t=function(t){return window.location.search.replace(/^\?/,"").split("&").map(t=>t.split("=")).find(e=>e[0]==t)[1]}("id");if(!/^[1-9][0-9]*$/.test(t)){return void(document.getElementById("title").innerHTML="not found")}const e=n(0).find(e=>e.id==t);if(!e){return void(document.getElementById("title").innerHTML="not found")}document.getElementById("title").innerHTML=e.title,document.getElementById("description").innerHTML=e.description;const r=document.getElementById("source");r.innerHTML="View on GitHub",r.href=e.source;const o=document.getElementById("container"),i=document.createElement("canvas");switch(o.appendChild(i),t){case"1":return n(5).start(i);case"2":return n(12).start(i);case"3":return n(20).start(i);case"4":return n(28).start(i)}}},function(t,e,n){e.start=t=>{t.width=500,t.height=500;const e=n(6).getContext(t),r=n(7).getShaderProgram(e);n(10).setAttributes(e,r);let o=0;window.setInterval(()=>{n(11).setUniforms(e,r,13*o,17*o,19*o),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.drawArrays(e.TRIANGLE_STRIP,0,4),o+=.003},15)}},function(t,e){e.getContext=t=>{const e=t.getContext("webgl2");return e.clearColor(0,0,0,1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e}},function(t,e,n){function r(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}e.getShaderProgram=t=>{const e=t.createProgram();return t.attachShader(e,r(t,t.VERTEX_SHADER,n(8).default)),t.attachShader(e,r(t,t.FRAGMENT_SHADER,n(9).default)),t.linkProgram(e),t.useProgram(e),e}},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\n#define GLSLIFY 1\nin vec3 pos;\nout vec4 hoge;\n\nuniform mat4 rotX;\nuniform mat4 rotY;\nuniform mat4 rotZ;\nuniform mat4 prj;\n\nvoid main(void) {\n    gl_Position = prj * (rotX * rotY * rotZ) * vec4(pos, 1.0);\n    hoge = (rotZ * rotY * rotX) * vec4(pos, 255.0);\n}"},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\nprecision mediump float;\n#define GLSLIFY 1\nin vec4 hoge;\nout vec4 color;\nvoid main(void) {\n    color = hoge;\n}"},function(t,e){e.setAttributes=(t,e)=>{const n=t.getAttribLocation(e,"pos");t.enableVertexAttribArray(n);const r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0]),t.STATIC_DRAW),t.vertexAttribPointer(n,3,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,null)}},function(t,e){e.setUniforms=(t,e,n,r,o)=>{const i=[1,0,0,0,0,Math.cos(n),-Math.sin(n),0,0,Math.sin(n),Math.cos(n),0,0,0,0,1];var a=t.getUniformLocation(e,"rotX");t.uniformMatrix4fv(a,!1,i);const s=[Math.cos(r),0,Math.sin(r),0,0,1,0,0,-Math.sin(r),0,Math.cos(r),0,0,0,0,1];a=t.getUniformLocation(e,"rotY"),t.uniformMatrix4fv(a,!1,s);const c=[Math.cos(o),-Math.sin(o),0,0,Math.sin(o),Math.cos(o),0,0,0,0,1,0,0,0,0,1];a=t.getUniformLocation(e,"rotZ"),t.uniformMatrix4fv(a,!1,c);a=t.getUniformLocation(e,"prj"),t.uniformMatrix4fv(a,!1,[.5,0,0,0,0,.5,0,0,0,0,.5,0,0,0,0,1])}},function(t,e,n){e.start=t=>{t.width=500,t.height=500;const e=n(13).getContext(t),r=n(14).getShaderProgram(e);n(17).setAttributes(e,r);const o=Date.now();!function t(){let i=(Date.now()-o)/6e3;n(19).setUniforms(e,r,13*i,17*i,19*i);e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);e.drawArrays(e.TRIANGLES,0,36);window.requestAnimationFrame(t)}()}},function(t,e){e.getContext=t=>{const e=t.getContext("webgl2");return e.clearColor(0,0,0,1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e}},function(t,e,n){e.getShaderProgram=t=>{const e=t.createProgram();return t.attachShader(e,r(t,t.VERTEX_SHADER,n(15).default)),t.attachShader(e,r(t,t.FRAGMENT_SHADER,n(16).default)),t.linkProgram(e),t.useProgram(e),e;function r(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}}},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\n#define GLSLIFY 1\nin vec3 pos;\nout vec4 color;\n\nuniform mat4 rotX;\nuniform mat4 rotY;\nuniform mat4 rotZ;\nuniform mat4 prj;\n\nvoid main(void) {\n    gl_Position = prj * (rotX * rotY * rotZ) * vec4(pos, 1.0);\n    color = vec4(pos, 255.0);\n}"},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\nprecision mediump float;\n#define GLSLIFY 1\nin vec4 color;\nout vec4 outColor;\nvoid main(void) {\n    outColor = floor(abs(color));\n}"},function(t,e,n){const r=n(18).getPoint;e.setAttributes=(t,e)=>{const n=t.getAttribLocation(e,"pos");t.enableVertexAttribArray(n);const o=r(1,1,1),i=r(1,-1,1),a=r(1,-1,-1),s=r(1,1,-1),c=r(-1,1,1),u=r(-1,-1,1),f=r(-1,-1,-1),l=r(-1,1,-1),d=[];function m(t,e,n,r){function o(t){d.push(t.x),d.push(t.y),d.push(t.z)}o(t),o(e),o(n),o(t),o(n),o(r)}m(o,i,a,s),m(c,u,f,l),m(o,i,u,c),m(a,s,l,f),m(i,a,f,u),m(s,o,c,l);const h=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,h),t.bufferData(t.ARRAY_BUFFER,new Float32Array(d),t.STATIC_DRAW),t.vertexAttribPointer(n,3,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,null)}},function(t,e){e.getPoint=(t,e,n)=>({x:t,y:e,z:n})},function(t,e){e.setUniforms=(t,e,n,r,o)=>{const i=[1,0,0,0,0,Math.cos(n),-Math.sin(n),0,0,Math.sin(n),Math.cos(n),0,0,0,0,1];var a=t.getUniformLocation(e,"rotX");t.uniformMatrix4fv(a,!1,i);const s=[Math.cos(r),0,Math.sin(r),0,0,1,0,0,-Math.sin(r),0,Math.cos(r),0,0,0,0,1];a=t.getUniformLocation(e,"rotY"),t.uniformMatrix4fv(a,!1,s);const c=[Math.cos(o),-Math.sin(o),0,0,Math.sin(o),Math.cos(o),0,0,0,0,1,0,0,0,0,1];a=t.getUniformLocation(e,"rotZ"),t.uniformMatrix4fv(a,!1,c);a=t.getUniformLocation(e,"prj"),t.uniformMatrix4fv(a,!1,[.5,0,0,0,0,.5,0,0,0,0,.5,0,0,0,0,1])}},function(t,e,n){e.start=t=>{t.width=500,t.height=500;const e=n(21).getContext(t),r=n(22).getShaderProgram(e);n(25).setAttributes(e,r);let o=null,i=null,a=n(1).rot_x(0);t.addEventListener("mousemove",function(t){null!=o&&null!=i||(o=t.offsetX,i=t.offsetY);const s=t.offsetX-o,c=t.offsetY-i;o=t.offsetX,i=t.offsetY;const u=n(1).rot_x(.01*c),f=n(1).rot_y(.01*s);a=u.mul(f).mul(a),n(27).setUniforms(e,r,a),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.drawArrays(e.TRIANGLES,0,36)},!1)}},function(t,e){e.getContext=t=>{const e=t.getContext("webgl2");return e.clearColor(0,0,0,1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e}},function(t,e,n){e.getShaderProgram=t=>{const e=t.createProgram();return t.attachShader(e,r(t,t.VERTEX_SHADER,n(23).default)),t.attachShader(e,r(t,t.FRAGMENT_SHADER,n(24).default)),t.linkProgram(e),t.useProgram(e),e;function r(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}}},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\n#define GLSLIFY 1\nin vec3 pos;\nout vec4 color;\n\nuniform mat4 rot;\nuniform mat4 prj;\n\nvoid main(void) {\n    gl_Position = prj * rot * vec4(pos, 1.0);\n    color = vec4(pos, 255.0);\n}"},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\nprecision mediump float;\n#define GLSLIFY 1\nin vec4 color;\nout vec4 outColor;\nvoid main(void) {\n    outColor = floor(abs(color));\n}"},function(t,e,n){const r=n(26).getPoint;e.setAttributes=(t,e)=>{const n=t.getAttribLocation(e,"pos");t.enableVertexAttribArray(n);const o=r(1,1,1),i=r(1,-1,1),a=r(1,-1,-1),s=r(1,1,-1),c=r(-1,1,1),u=r(-1,-1,1),f=r(-1,-1,-1),l=r(-1,1,-1),d=[];function m(t,e,n,r){function o(t){d.push(t.x),d.push(t.y),d.push(t.z)}o(t),o(e),o(n),o(t),o(n),o(r)}m(o,i,a,s),m(c,u,f,l),m(o,i,u,c),m(a,s,l,f),m(i,a,f,u),m(s,o,c,l);const h=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,h),t.bufferData(t.ARRAY_BUFFER,new Float32Array(d),t.STATIC_DRAW),t.vertexAttribPointer(n,3,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,null)}},function(t,e){e.getPoint=(t,e,n)=>({x:t,y:e,z:n})},function(t,e){e.setUniforms=(t,e,n)=>{let r=t.getUniformLocation(e,"rot");t.uniformMatrix4fv(r,!1,n.getArray());r=t.getUniformLocation(e,"prj"),t.uniformMatrix4fv(r,!1,[.5,0,0,0,0,.5,0,0,0,0,.5,0,0,0,0,1])}},function(t,e,n){e.start=t=>{const e=n(29).getContext(t);n(30).getShaderProgram(e),n(33).setTransformFeedback(e),e.enable(e.RASTERIZER_DISCARD),e.beginTransformFeedback(e.POINTS),e.drawArrays(e.POINTS,0,1),e.endTransformFeedback(),e.disable(e.RASTERIZER_DISCARD);const r=new Float32Array(4);e.getBufferSubData(e.TRANSFORM_FEEDBACK_BUFFER,0,r),console.log(r)}},function(t,e){e.getContext=t=>t.getContext("webgl2")},function(t,e,n){e.getShaderProgram=t=>{const e=t.createProgram();return t.attachShader(e,r(t,t.VERTEX_SHADER,n(31).default)),t.attachShader(e,r(t,t.FRAGMENT_SHADER,n(32).default)),t.transformFeedbackVaryings(e,["result"],t.SEPARATE_ATTRIBS),t.linkProgram(e),t.useProgram(e),e;function r(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}}},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\n#define GLSLIFY 1\nout vec4 result;\nvoid main(void) {\n    result = vec4(1.0, 2.0, 3.0, 4.0) * 2.0;\n}"},function(t,e,n){"use strict";n.r(e),e.default="#version 300 es\n#define GLSLIFY 1\nvoid main(void) {\n}"},function(t,e){e.setTransformFeedback=t=>{const e=t.createBuffer(),n=t.createTransformFeedback();t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,4*Float32Array.BYTES_PER_ELEMENT,t.DYNAMIC_COPY),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,n),t.bindBufferBase(t.TRANSFORM_FEEDBACK_BUFFER,0,e)}}]);